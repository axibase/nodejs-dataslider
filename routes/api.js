'use strict';var express = require('express');var fs = require('fs');var Cacher = require('../helpers/cacher').Cacher;var logger = require('npmlog');var Series = require('atsd-api').Series;var fileHelper = require('../helpers/file-helper');var config = require('../config');var bodyParser = require('body-parser');var multer = require('multer'); // v1.0.5var upload = multer(); // for parsing multipart/form-datavar NodeCache = require("node-cache");var myCache = new NodeCache({stdTTL: 60 * 60 * 24, checkperiod: 120});var crypto = require('crypto');module.exports = (function () {    var api = express.Router();    var cacher = new Cacher(config.cacheFolder);    var options = fileHelper.readApiOptions();    var series = new Series(options);    api.use(bodyParser.json()); // for parsing apilication/json    api.use(bodyParser.urlencoded({extended: true})); // for parsing apilication/x-www-form-urlencoded    api.post('/series', upload.array(), function (req, res) {        series.query(req.body, function (error, response, data) {            if (error) {                logger.error(err);            }            res.json(data);        });    });    return api;})();